# Домашнее задание к занятию «Программирование на языке LD»

### Цель задания

Получить опыт создания программ на языке LAD, аналоге языка LD от компании Siemens, в программном проекте в TIA Portal 13.

В результате выполнения этого задания вы сможете:

- вносить изменения в программный код на языке LAD в соответствии с заданием;
- получить опыт работы с системой TIA Portal в части программирования на языке LAD и программой PLCSIM в части разработки, загрузки и отладки программ.

------

### Чеклист готовности к домашнему заданию

1. Зарегистрируйтесь на [портале Siemens](https://mall.industry.siemens.com/goos/WelcomePage.aspx?regionUrl=/ru&language=ru) и получите персональный логин и пароль для входа в систему. Процесс регистрации описан в [инструкции](https://u.netology.ru/backend/uploads/lms/content_assets/file/338/%D0%98%D0%BD%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%86%D0%B8%D1%8F_%D0%BF%D0%BE_%D1%80%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8_%D0%BD%D0%B0_%D0%BF%D0%BE%D1%80%D1%82%D0%B0%D0%BB%D0%B5_Siemens.pptx).
2. Загрузите с [официального ресурса Siemens](https://support.industry.siemens.com/cs/document/78793685/simatic-step-7-(tia-portal)-v13-trial-download?dti=0&lc=en-DE) и установите программное обеспечение для создания проекта PLC Siemens, входящее в состав пакета TIA Portal. 
3. Скачайте [архив программного проекта Netology_Project_LD](https://u.netology.ru/backend/uploads/lms/content_assets/file/4371/Netology_Project_LD.zap13) и распакуйте его, используя функцию Retrieve среды программирования TIA Portal.

<details>
  <summary> Подсказка по установке (доступна по клику). </summary>
  
  
1. Скачайте все файлы по [ссылке](https://support.industry.siemens.com/cs/document/109745155/simatic-step-7-including-plcsim-v13-sp2-trial-download?dti=0&lc=en-DE) в две отдельные папки:
  
  - STEP 7 Professional V13 SP2 (DVD 1, DVD 2, SHA-256 checksum).
 
  ![image](https://github.com/netology-code/phd-homeworks/blob/main/6.6/Step7_1.png)
 
  - SIMATIC STEP 7 PLCSIM V13 SP2 for STEP 7 Basic and STEP 7 Professional, включая SHA-256 checksum.
   
    ![image](https://github.com/netology-code/phd-homeworks/blob/main/6.6/Step7_2.png)

2. Запустите установочный файл SIMATIC_STEP_7_Professional_V13_SP2_Upd4.exe, пройдите стандартную процедуру установки.
3. Запустите установочный файл SIMATIC_S7_PLCSIM_V13_SP2.exe, пройдите стандартную процедуру установки.

   **Подсказка по распаковке архиватором WinRAR:**

Если скачанный дистрибутив TIA Portal содержит некоторые файлы с расширением 001, это вызовет проблему при распаковке данных.

Это происходит, потому что некоторые версии архиватора WinRAR, установленные на ПК, ассоциируют файлы с именем 001, как файлы с расширением .rar.

Для решения проблемы можно убрать ассоциацию:

1. Найдите архиватор WinRAR, имеющий окончание 001.
2. Откройте его двойным кликом, далее выбирайте Установка ⇒ Интеграция.
3. В окне слева будет перечень форматов, которые по умолчанию ассоциируются с WinRAR.
4. Уберите галочку с формата 001, нажмите ОК и перезагрузите ПК.

Скрин с действиями дан ниже:
 ![image](https://github.com/netology-code/scada-4-homeworks/blob/scada-7/WinRAR.png)

-----
  
</details>
  
**Обратите внимание.** Устанавливается демо-версия программы. Её функционал будет ограничен через 21 день после установки. Рекомендуем установку софта на виртуальной машине. Как это сделать, описано в [инструкции](https://u.netology.ru/backend/uploads/lms/content_assets/file/339/%D0%98%D0%BD%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%86%D0%B8%D1%8F_%D0%BF%D0%BE_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8E_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%8B_%D0%B8_%D0%BE%D1%82%D0%BA%D0%B0%D1%82%D1%83.pptx).


------

### Инструкция к заданию

1. Скачайте [«Шаблон для домашнего задания»](https://u.netology.ru/backend/uploads/lms/content_assets/file/4372/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD_%D0%B4%D0%BB%D1%8F_%D0%B4%D0%BE%D0%BC%D0%B0%D1%88%D0%BD%D0%B5%D0%B3%D0%BE_%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F__%D0%9F%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BD%D0%B0_%D1%8F%D0%B7%D1%8B%D0%BA%D0%B5_LD__-_%D0%A4%D0%B0%D0%BC%D0%B8%D0%BB%D0%B8%D1%8F_%D0%98%D0%BC%D1%8F__%D0%A1%D0%94%D0%95%D0%9B%D0%90%D0%99%D0%A2%D0%95_%D0%9A%D0%9E%D0%9F%D0%98%D0%AE_.docx) на своё устройство.
2. Откройте скачанный файл на личном диске в Google.
3. В названии файла введите корректное название лекции и ваши фамилию и имя.
4. Зайдите в «Настройки доступа» и выберите доступ «Просматривать могут все в интернете, у кого есть ссылка». Инструкция «Как предоставить доступ к файлам и папкам на Google Диске» [по ссылке](https://support.google.com/docs/answer/2494822?hl=ru&co=GENIE.Platform%3DDesktop).
5. Скопируйте текст задания в свой документ.
6. Выполните задание, запишите ответы и приложите необходимые скриншоты в свой Google-документ.
7. Для проверки домашнего задания отправьте ссылку на ваш Google-документ в личном кабинете.
8. Любые вопросы по решению задач можно задать в [чате поддержки](https://netology.ru/profile?modal=support&type=new-ticket) или в разделе «Вопросы по заданию» при выполнении практических заданий.
9. Подробнее о работе с Google-документами и загрузке решения на проверку можно найти в [«Руководстве по работе с материалами для обучения»](https://l.netology.ru/instruktsiya-po-materialami-dlya-obucheniya)


------

### Инструменты и дополнительные материалы для выполнения задания

1. [TIA Portal 13, PLCSIM 13](https://support.industry.siemens.com/cs/document/109745155/simatic-step-7-including-plcsim-v13-sp2-trial-download?dti=0&lc=en-WW).
2. [Архив проекта Netology_Project_LD](https://u.netology.ru/backend/uploads/lms/content_assets/file/4371/Netology_Project_LD.zap13).
3. [Инструкция по созданию виртуальной машины](https://u.netology.ru/backend/uploads/lms/content_assets/file/339/%D0%98%D0%BD%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%86%D0%B8%D1%8F_%D0%BF%D0%BE_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8E_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%8B_%D0%B8_%D0%BE%D1%82%D0%BA%D0%B0%D1%82%D1%83.pptx).
4. [Шаблон для домашнего задания](https://u.netology.ru/backend/uploads/lms/content_assets/file/4372/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD_%D0%B4%D0%BB%D1%8F_%D0%B4%D0%BE%D0%BC%D0%B0%D1%88%D0%BD%D0%B5%D0%B3%D0%BE_%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F__%D0%9F%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BD%D0%B0_%D1%8F%D0%B7%D1%8B%D0%BA%D0%B5_LD__-_%D0%A4%D0%B0%D0%BC%D0%B8%D0%BB%D0%B8%D1%8F_%D0%98%D0%BC%D1%8F__%D0%A1%D0%94%D0%95%D0%9B%D0%90%D0%99%D0%A2%D0%95_%D0%9A%D0%9E%D0%9F%D0%98%D0%AE_.docx).

------

### Задание 1

1. В [проекте Netology_Project_LD](https://u.netology.ru/backend/uploads/lms/content_assets/file/4371/Netology_Project_LD.zap13) проделайте операции для возможности управления нормально открытым отсечным клапаном:
  - методом Copy-Paste скопируйте в папке Program Blocks функциональный блок LAD_ValveCtrl_FB и вставьте его, изменив название на LAD_ValveRevCtrl_FB;
  - внесите в код программы нового функционального блока изменения, необходимые для управления нормально открытым клапаном с помощью этого FB: при формировании на входе CMDIN команды «Открыть» (логическая «1») на выходе CMDOUT должен формироваться логический «0» и наоборот;
  - при необходимости измените признаки формирования ошибки (выход Err) в части несоответствия значений входов CMDIN и FBO.

  **Примечание:** нормально открытый отсечной клапан принимает подаваемое от канала DO значение команды «0», как «Открыть», значение команды «1», как «Закрыть».

2. Добавьте экземпляр вновь созданного функционального блока LAD_ValveRevCtrl_FB в Network 3 организационного блока LAD_Program_OB.
3. Произведите привязки входов и выходов этого экземпляра следующим образом:
  - вход FBC — к адресу I 1.3;
  - вход FBO — к адресу I 1.4;
  - вход CMDIN — к адресу M 2.1;
  - выход CMDOUT — к адресу Q 0.2;
  - выход Err — к адресу M 2.3.

4. Произведите компиляцию проекта и его загрузку в PLCSIM.
5. Убедитесь в правильности работы экземпляра блока, подавая команды открытия и закрытия на вход CMDIN и соответствующим образом изменяя значения входов FBC, FBO, чтобы не допустить формирования ошибки.
6. Сделайте скриншоты функционального блока LAD_ValveRevCtrl_FB (Network 1, Network 2), а также Network 3 организационного блока LAD_Program_OB в вариантах подачи команды закрытия и открытия на вход CMDIN экземпляра блока.
7. Приложите скриншоты к заданию.

------

### Задание 2

1. Измените организационный блок LAD_Program_OB, добавив в Network 4 новый программный код:

  - программа должна отслеживать команду, подаваемую на аналоговый клапан — экземпляр функционального блока LAD_AnalogValve_FB в Network 2 того же OB;
  - если команда на аналоговый клапан примет значение более 80%, то нужно подать команду на открытие отсечного клапана — экземпляр функционального блока LAD_ValveCtrl_FB в Network 1 того же OB;
  - если команда на аналоговый клапан примет значение менее 20%, то нужно подать команду на закрытие отсечного клапана;
  - если команда на аналоговый клапан находится в диапазоне от 20% до 80%, то нужно сохранять последнюю активную команду отсечного клапана;
  - команду на аналоговый клапан считывать из параметра, привязанного ко входу CMDIN экземпляра FB аналогового клапана;
  - команду на отсечной клапан формировать, записывать в параметр, привязанный ко входу CMDIN экземпляра FB отсечного клапана.

  **Примечание:** рекомендуется использовать элементы «Взвести значение» (S) и «Сбросить значение» (R).

2. Произведите компиляцию проекта и его загрузку в PLCSIM.
3. Измените значения команды для аналогового клапана так, чтобы выполнялись условия сначала на открытие, а затем на закрытие отсечного клапана (см. далее).
4. Сделайте скриншоты Network 4 для ситуаций:
  - команда на аналоговый клапан = 85%;
  - команда на аналоговый клапан = 55% (должна сохраняться команда на открытие отсечного клапана);
  - команда на аналоговый клапан = 15%;
  - команда на аналоговый клапан = 55% (должна сохраняться команда на закрытие отсечного клапана).

5. Приложите скриншоты к заданию.

------

### Правила приёма работы

1. Отправлена ссылка на документ (Google Doc) с выполненным заданием в личном кабинете.
2. Документ размещён на личном Google Диске.
3. К документу настроены права доступа «Просматривать могут все в интернете, у кого есть ссылка».

------

### Критерии оценки

1. Задание 1 считается выполненным, если на приложенных скриншотах приведён корректный программный код функционального блока LAD_ValveRevCtrl_FB, присутствуют корректные значения команд и концевых выключателей клапана в Network 3 организационного блока.

2. Задание 2 считается выполненным, если на приложенных скриншотах показаны верные значения команды, подаваемой на отсечной клапан.
