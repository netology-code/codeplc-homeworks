# Домашнее задание к занятию «Программирование на языке LD»

### Цель задания

Выполнив домашнее задание, вы получите опыт создания программ на языке SCL (аналоге языка ST от компании Siemens) в программном проекте в TIA Portal 13.

В результате выполнения этого задания вы сможете:

1. Вносить изменения в программный код на языке SCL в соответствии с заданием.
2. Получить опыт работы с системой TIA Portal (в части программирования на языке SCL) и программой PLCSIM в части разработки, загрузки и отладки программ.

------

### Чеклист готовности к домашнему заданию

1. Зарегистрируйтесь на [портале Siemens](https://mall.industry.siemens.com/goos/WelcomePage.aspx?regionUrl=/ru&language=ru) и получите персональный логин и пароль для входа в систему. Процесс регистрации описан в [соответствующей инструкции](https://docs.google.com/presentation/d/1RPHvCE2OxBbHRMWSAV2E-HxscZvR2nRIZVHCy8hvjJE/edit?usp=sharing).
2. Загрузите и установите программное обеспечение для создания проекта PLC Siemens, входящее в состав пакета TIA Portal с [официального ресурса Siemens](https://support.industry.siemens.com/cs/document/78793685/simatic-step-7-(tia-portal)-v13-trial-download?dti=0&lc=en-DE)
<details>
  <summary> Подсказка по установке (доступна по клику)</summary>
  
  
1. Скачайте все файлы по [ссылке](https://support.industry.siemens.com/cs/document/109745155/simatic-step-7-including-plcsim-v13-sp2-trial-download?dti=0&lc=en-DE) в две отдельные папки:
  - STEP 7 Professional V13 SP2 (DVD 1, DVD 2, SHA-256 checksum)
  ![image](https://github.com/netology-code/phd-homeworks/blob/main/6.6/Step7_1.png)
  - SIMATIC STEP 7 PLCSIM V13 SP2 for STEP 7 Basic and STEP 7 Professional (включая SHA-256 checksum)
    ![image](https://github.com/netology-code/phd-homeworks/blob/main/6.6/Step7_2.png)
2. Запустите установочный файл SIMATIC_STEP_7_Professional_V13_SP2_Upd4.exe, пройдите стандартную процедуру установки.
3. Запустите установочный файл SIMATIC_S7_PLCSIM_V13_SP2.exe, пройдите стандартную процедуру установки.

    ---
  
</details>
  
*ОБРАТИТЕ ВНИМАНИЕ! Устанавливается демо-версия программы. Её функционал будет ограничен спустя 21 день после установки. Рекомендуется установка софта на виртуальной машине. Как это сделать, описано в [инструкции](https://docs.google.com/presentation/d/1psnSlotXT7cr8ECnaZaTCDLnIyYOGUzCArLeydeRztY/edit?usp=sharing).*

3. Скачайте по указанной ссылке [архив программного проекта Netology_Project_LD](https://drive.google.com/file/d/1mkh1KT8gYucOxA2c1kkYDGugtQuWVhhV/view?usp=sharing) и распакуйте его, используя функцию Retrieve среды программирования TIA Portal.

------

### Инструкция к заданию

1. Сделайте копию [Шаблона для домашнего задания](https://docs.google.com/document/d/1hzgoSY8iJkuY74o07KMiuHO57MyPv7cTkXEkLE3N1wY/edit?usp=sharing) себе на Google Диск.
2. В названии файла введите корректное название лекции и вашу фамилию и имя.
3. Зайдите в «Настройки доступа» и выберите доступ «Просматривать могут все в Интернете, у кого есть ссылка». Ссылка на инструкцию Как предоставить доступ к файлам и папкам на Google Диске
4. Скопируйте текст задания в свой документ.
5. Выполните домашнее задание, запишите ответы и приложите необходимые скриншоты в свой Google Doc.
6. Для проверки домашнего задания преподавателем отправьте ссылку на ваш документ в личном кабинете.
7. Любые вопросы по решению задач задавайте в чате учебной группы.

------

### Инструменты/ дополнительные материалы, которые пригодятся для выполнения задания

1. [TIA Portal 13, PLCSIM 13](https://support.industry.siemens.com/cs/document/109745155/simatic-step-7-including-plcsim-v13-sp2-trial-download?dti=0&lc=en-WW)
2. [Архив проекта Netology_Project_LD](https://drive.google.com/file/d/1mkh1KT8gYucOxA2c1kkYDGugtQuWVhhV/view?usp=sharing)
3. [Инструкция по созданию виртуальной машины](https://docs.google.com/presentation/d/1psnSlotXT7cr8ECnaZaTCDLnIyYOGUzCArLeydeRztY/edit?usp=sharing)
4. [Шаблон для домашнего задания](https://docs.google.com/document/d/1hzgoSY8iJkuY74o07KMiuHO57MyPv7cTkXEkLE3N1wY/edit?usp=sharing)

------

### Задание 1

1. В [проекте Netology_Project_LD](https://drive.google.com/file/d/1mkh1KT8gYucOxA2c1kkYDGugtQuWVhhV/view?usp=sharing) проделайте описанные ниже операции:
- нормально открытый отсечной клапан принимает значение команды с0» как «Открыть», значение команды «1» - как «Закрыть»
- методом Copy-Paste скопируйте в папке Program Blocks функциональный блок LAD_ValveCtrl_FB и вставьте его, изменив название на LAD_ValveRevCtrl_FB
- внесите в код программы нового функционального блока изменения, необходимые для управления нормально открытым клапаном с помощью данного FB: при формировании на входе CmdIn команды «Открыть» (логическая «1») на выходе CmdOut должен формироваться логический «0» и наоборот
- при необходимости измените признаки формирования ошибки (выход Err) в части несоответствия значений входов CmdIn и FBO

2. Добавьте экземпляр вновь созданного функционального блока LAD_ValveRevCtrl_FB в Network 3 организационного блока LAD_Program_OB.
3. Произведите привязки входов и выходов этого экземпляра следующим образом:
- вход FBC - к адресу I 1.3
- вход FBO - к адресу I 1.4
- вход CmdIn - к адресу M 2.1
- выход CmdOut - к адресу Q 0.2
- выход Err - к адресу M 2.3.

4. Произведите компиляцию проекта и его загрузку в PLCSIM.
5. Убедитесь в правильности работы экземпляра блока, подавая команды открытия / закрытия на вход CmdIn и соответствующим образом изменяя значения входов FBC, FBO, чтобы не допустить формирования ошибки.
6. Сделайте скриншоты функционального блока LAD_ValveRevCtrl_FB (Network 1, Network 2), а также Network 3 организационного блока LAD_Program_OB (в вариантах подачи команды закрытия и открытия на вход CmdIn экземпляра блока).
7. Приложите скриншоты к заданию.
------

### Задание 2

1. Измените организационный блок LAD_Program_OB, добавив в Network 4 указанный ниже функционал:

- программа должна отслеживать команду, подаваемую на аналоговый клапан (экземпляр функционального блока LAD_AnalogValve_FB в Network 2 того же OB)
- если команда на аналоговый клапан примет значение более 80%, то необходимо подать команду на открытие отсечного клапана (экземпляр функционального блока LAD_ValveCtrl_FB в Network 1 того же OB)
- если команда на аналоговый клапан примет значение менее 20%, то необходимо подать команду на закрытие отсечного клапана
- если команда на аналоговый клапан находится в диапазоне от 20% до 80%, то необходимо сохранять последнюю активную команду отсечного клапана
- команду на аналоговый клапан считывать из параметра, привязанного ко входу CmdIn экземпляра FB аналогового клапана
- команду на отсечной клапан формировать (записывать) в параметр, привязанный ко входу CmdIn экземпляра FB отсечного клапана
- рекомендуется использовать элементы «Взвести значение» (S) и «Сбросить значение» (R).

2. Произведите компиляцию проекта и его загрузку в PLCSIM.
3. Измените значения команды для аналогового клапана таким образом, чтобы выполнялись условия сначала на открытие, а затем - на закрытие отсечного клапана (см. далее).
4. Сделайте скриншоты Network 4 для следующих ситуаций:
- команда на аналоговый клапан = 85%
- команда на аналоговый клапан = 55% (должна сохраняться команда на открытие отсечного клапана)
- команда на аналоговый клапан = 25%
- команда на аналоговый клапан = 55% (должна сохраняться команда на закрытие отсечного клапана).

5. Приложите скриншоты к заданию.

------

### Правила приёма работы

1. Отправлена ссылка на документ (Google Doc) с выполненным заданием в личном кабинете.
2. Документ размещён на личном Google Диске.
3. К документу настроены права доступа «Просматривать могут все в Интернете, у кого есть ссылка».

------

### Критерии оценки

1. Задание 1 считается выполненным, если на приложенных скриншотах приведен корректный программный код функционального блока LAD_ValveRevCtrl_FB, а также присутствуют корректные значения команд и концевых выключателей клапана в Network 3 организационного блока.

2. Задание 2 считается выполненным, если на приложенных скриншотах показаны верные значения команды, подаваемой на отсечной клапан.
